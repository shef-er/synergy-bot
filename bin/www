#!/usr/bin/env node

/**
 * Module dependencies.
 */

var app = require('../app');
var debug = require('debug')('synergy-bot:server');
//var http = require('http');


process.env.TOKEN = '63faee37962cac78da9a7993674d02fe945660986b0dd22f222a0beea76fac950047e52b04f86b1f0d501';

const API = require('../node-vk-bot-api/index.js');

const bot = new API(process.env.TOKEN);


// DB
var sqlite3 = require('sqlite3').verbose();
var db = new sqlite3.Database('../users.db', (err) => {
    if (err) {
        console.error(err.message);
    }
    console.log('Connected to the users database.');
});

//db.run("CREATE TABLE users(user_id UNIQUE, cats TEXT);");
//db.run("UPDATE users SELECT cats = ? WHERE user_id = ?", "" , 2);

/*
db.serialize(function() {
    db.run("CREATE TABLE users (user_id TEXT, cats TEXT)");

    var stmt = db.prepare("INSERT INTO cats VALUES (?)");
    for (var i = 0; i < 10; i++) {
        stmt.run("Ipsum " + i);
    }
    stmt.finalize();


    db.each("SELECT rowid AS id, info FROM cats", function(err, row) {
        console.log(row.id + ": " + row.info);
    });
});
*/

db.close();

bot.command('start', ({ reply }) => reply('This is start!'));

bot.hears(/(car|tesla)/, ({ reply }) => reply('I love Tesla!'));
bot.on(({ reply }) => reply('What?'));

bot.listen();